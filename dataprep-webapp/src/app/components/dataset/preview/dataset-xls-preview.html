<!--
  ~ ============================================================================
  ~
  ~  Copyright (C) 2006-2018 Talend Inc. - www.talend.com
  ~
  ~  This source code is available under agreement available at
  ~  https://github.com/Talend/data-prep/blob/master/LICENSE
  ~
  ~  You should have received a copy of the agreement
  ~  along with this program; if not, write to Talend SA
  ~  9 rue Pages 92150 Suresnes, France
  ~
  ~ ============================================================================
  -->

<talend-modal fullscreen="false"
              close-button="true"
              state="previewCtrl.visible">
    <div class="modal-title" translate-once="IMPORT_EXCEL_FILE"></div>

    <form class="form-horizontal">
        <div class="dataset-sheet-preview" ng-switch="previewCtrl.datasetSheetPreviewService.addPreparation">
            <div class="form-group" ng-switch-when="true">
                <label class="col-sm-2 control-label" translate-once="PREPARATION_NAME"></label>
                <div class="col-sm-10">
                    <input type="text"
                           class="form-control"
                           ng-model="previewCtrl.datasetSheetPreviewService.preparationName"/>
                </div>
            </div>
            <div class="form-group" ng-switch-when="false">
                <label class="col-sm-2 control-label" translate-once="DATASET_NAME"></label>
                <div class="col-sm-10">
                    <input type="text"
                           class="form-control"
                           ng-model="previewCtrl.metadata.name"/>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label" translate-once="STYLESHEET"></label>
                <div class="col-sm-10">
                    <select class="form-control"
                            ng-options="sheetContent.name as sheetContent.name for sheetContent in previewCtrl.metadata.schemaParserResult.sheetContents"
                            ng-model="previewCtrl.selectedSheetName"
                            ng-change="previewCtrl.selectSheet()"></select>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label" translate-once="CONTENT_100_FIRST_ROWS"></label>
                <div class="col-sm-10">
                    <div id="datasetSheetPreviewGrid" class="datagrid"></div>
                </div>
            </div>
        </div>

        <div class="modal-buttons">
            <button type="button"
                    class="btn talend-modal-close btn-default modal-secondary-button"
                    ng-click="confirmCtrl.cancel()"
                    translate-once="CANCEL"></button>
            <button type="submit"
                    class="btn talend-modal-close btn-primary modal-primary-button"
                    ng-click="previewCtrl.setDatasetSheet()"
                    ng-disabled="previewCtrl.disableDatasetSheetConfirm()"
                    translate-once="CONFIRM"></button>
        </div>
    </form>
</talend-modal>
